<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>In√≠cio ‚Äî NuApp</title>
  <link rel="stylesheet" href="style.css" /> 
  <style>
    /* * NOTA: Estes estilos s√£o espec√≠ficos da p√°gina e complementam
     * as vari√°veis de cores (var(--brand), etc.) definidas no seu style.css. 
    */
    .welcome-container {
      max-width: 980px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    /* Estilo da √°rea de sauda√ß√£o */
    .greeting-area {
      padding: 0 0 16px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .greeting-area h2 {
      margin: 0;
      font-size: 26px;
      font-weight: 700;
    }
    .greeting-area .actions {
      display: flex;
      gap: 16px;
      align-items: center; /* Alinha os bot√µes/√≠cones verticalmente */
    }
    /* √çcone de olho e configura√ß√µes */
    .greeting-area .icon-btn {
      background: #f0f0f5; /* Fundo cinza claro */
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    /* √Årea de Saldo/Fatura */
    .balance-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px 24px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .balance-card h3 {
      font-size: 16px;
      color: var(--dark);
      margin-top: 0;
      margin-bottom: 8px;
    }
    .balance-card p {
      font-size: 28px;
      font-weight: 700;
      margin: 0;
      color: var(--dark);
    }

    /* √Årea de Navega√ß√£o (Hub) - Rolagem Horizontal */
    .nav-hub {
      display: flex;
      gap: 10px;
      overflow-x: auto; 
      padding: 10px 0;
      margin-bottom: 20px;
      -webkit-overflow-scrolling: touch;
    }
    .nav-hub .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 80px;
      min-width: 80px;
      text-align: center;
      cursor: pointer;
    }
    .nav-hub .nav-icon {
      background: #f0f0f5;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 6px;
      color: var(--dark);
      font-size: 20px;
    }
    .nav-hub small {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.2;
    }
    
    /* ESTILO DO CARD DE DESTAQUE DO MARKETPLACE */
    .marketplace-text-card {
        background: #f0f0f5; 
        padding: 18px 24px;
        border-radius: var(--radius);
        cursor: pointer;
        transition: background 0.2s;
        font-weight: 500;
        color: var(--dark);
        font-size: 15px;
        line-height: 1.4;
    }
    .marketplace-text-card:hover {
        background: #e6e6ee;
    }
    .marketplace-text-card span {
        color: var(--brand); 
        font-weight: 700;
    }

  </style>
</head>
<body>
  
  <div class="welcome-container">
    <div class="greeting-area">
      <h2 id="userGreeting">Ol√°, Usu√°rio</h2>
      <div class="actions">
        <button id="btnAdmin" class="action-btn action-edit" style="display:none;">Admin</button> 
        
        <div class="icon-btn">üëÅÔ∏è</div>
        <div class="icon-btn">‚öôÔ∏è</div>
        <button id="btnLogout" class="action-btn action-delete">Sair</button>
      </div>
    </div>

    <div class="balance-card">
        <h3>Conta</h3>
        <p>R$ <span id="balanceValue">1.250,00</span></p>
    </div>

    <div class="nav-hub">
        <div class="nav-item">
            <div class="nav-icon">üí∏</div>
            <small>Transferir</small>
        </div>
        <div class="nav-item">
            <div class="nav-icon">üí∞</div>
            <small>Pagar</small>
        </div>
        <div class="nav-item">
            <div class="nav-icon">üí≥</div>
            <small>Cart√£o</small>
        </div>
        <div class="nav-item">
            <div class="nav-icon">‚öôÔ∏è</div>
            <small>Config.</small>
        </div>
        <div class="nav-item">
            <div class="nav-icon">üè†</div>
            <small>Empr√©stimos</small>
        </div>
    </div>
    
    <div class="marketplace-text-card">
        Explore o nosso marketplace! Encontre ofertas exclusivas e descontos em lojas parceiras. 
        <br>
        <span onclick="alert('Indo para o Marketplace!')">Clique e confira.</span>
    </div>

  </div>

  <script>
    // URL base da sua API do json-server
    const API = 'users';

    // 1. Fun√ß√£o para obter a sess√£o do localStorage
    function getSession() {
        const s = localStorage.getItem('sessionUser');
        return s ? JSON.parse(s) : null;
    }

    // 2. Fun√ß√£o para carregar o nome do usu√°rio e atualizar a sauda√ß√£o
    async function loadUserName(id) {
        try {
            const res = await fetch(`${API}/${id}`);
            const user = await res.json();
            if (user && user.nome) {
                // Pega apenas o primeiro nome
                document.getElementById('userGreeting').textContent = `Ol√°, ${user.nome.split(' ')[0]}`;
            }
        } catch (err) {
            console.error("Erro ao carregar nome do usu√°rio:", err);
        }
    }

    // 3. L√≥gica principal de inicializa√ß√£o da p√°gina
    const session = getSession();

    if (!session) {
        // Se n√£o houver sess√£o, redireciona para o login
        window.location.href = 'index.html'; 
    } else {
        // Carrega o nome do usu√°rio logado
        loadUserName(session.id);
        
        // Exibe o bot√£o de Admin se o papel for 'admin'
        if (session.role === 'admin') {
            const btnAdmin = document.getElementById('btnAdmin');
            btnAdmin.style.display = 'inline-block'; 
            
            // Define a a√ß√£o de clique do bot√£o Admin
            btnAdmin.addEventListener('click', () => {
                window.location.href = 'admin.html';
            });
        }
    }

    // 4. L√≥gica do bot√£o de Sair (Logout)
    document.getElementById('btnLogout').addEventListener('click', () => {
        localStorage.removeItem('sessionUser');
        window.location.href = 'index.html';
    });
  </script>
</body>

</html>
